(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,,,,function(e,t,a){},,,function(e,t,a){e.exports=a.p+"static/media/testLogo.4791f781.png"},function(e,t,a){e.exports=a(32)},,,,,,function(e,t,a){},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t){e.exports="data:image/png;base64,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"},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(13),o=a.n(r),l=(a(22),a(5)),s=a(6),c=a(9),u=a(7),m=a(10),d=a(1),g=a(4),f=["user-top-read"],h=window.location.hash.substring(1).split("&").reduce(function(e,t){if(t){var a=t.split("=");e[a[0]]=decodeURIComponent(a[1])}return e},{});window.location.hash="";var v=h,p=(a(12),a(2)),y=function(){var e=Object(n.useState)({winWidth:window.innerWidth,winHeight:window.innerHeight}),t=Object(p.a)(e,2),a=t[0],i=t[1],r=function(){i({winWidth:window.innerWidth,winHeight:window.innerHeight})};return Object(n.useEffect)(function(){return window.addEventListener("resize",r),function(){window.removeEventListener("resize",r)}},[a]),a.winWidth},w=a(8);var E=a(14);function A(e,t,a,n){return[e/100*(a-n),t/100*(a-n)]}a(27),a(28);function S(e){var t=e.genres;return i.a.createElement("div",{className:"parent"},t.map(function(e){return i.a.createElement("p",{key:e,className:"genreComponent"}," ",e," ")}))}function b(e){var t=e.x,a=e.y,r=e.imageSize,o=e.axisLength,l=e.popularity,s=e.valence,c=e.songInfo,u=e.smallFormat,m=e.isMobile,d=e.setHovered,g=function(e,t,a,n){var i={};for(var r in e)if(r in t){var o=A(e[r],t[r],a,n)[0],l=A(e[r],t[r],a,n)[0]+n,s=A(e[r],t[r],a,n)[1],c=A(e[r],t[r],a,n)[1]+n;i[r]=[o,l,s,c]}return i}(l,s,o,r),f=null;for(var h in g){var v=g[h][0],y=g[h][1],w=g[h][2],E=g[h][3];t>=v&&t<=y&&a>=w&&a<=E&&(f=h)}var b=Object(n.useState)(0),O=Object(p.a)(b,2),k=O[0],N=O[1],x=document.getElementById("test");return null!==x&&k!=x.clientHeight&&N(x.clientHeight),i.a.createElement("div",{style:{height:k+20}},function(){if(null!=f&&f in c){var e=c[f].track;m||d(e);for(var t=c[f].artists,a="",n=0;n<t.length;n++)0===n?a+=t[n].name:a=a+", "+t[n].name;var r=c[f].genres,o="songInfo";return u&&(o="smallSongInfo"),m&&(o="mobile"),i.a.createElement("div",{className:"container"},i.a.createElement("div",{className:o},i.a.createElement("div",{style:{display:"flex",overflow:"hidden"}},m?i.a.createElement("img",{src:c[f].src,alt:"image of album cover",className:"songCover"}):null,i.a.createElement("div",null,i.a.createElement("p",{className:"name"},i.a.createElement("strong",null," ",e," ")),i.a.createElement("p",{className:"artist"},a),i.a.createElement(S,{genres:r})))))}if(m){var l=[],s=[],g=1;for(var h in c)g<6?l.push(c[h].track):s.push(c[h].track),g++;return l.length<=0||s.length<=0?i.a.createElement("div",null,i.a.createElement("h2",{className:"loading"}," Loading Your Songs... "),i.a.createElement("p",{className:"loadingTime"},"If this process takes > 2 minutes, please refresh or try again later. ")):i.a.createElement("div",{id:"test",className:"topzz"},i.a.createElement("h2",{className:"top10"}," Your Top 10 "),i.a.createElement("p",{className:"learnMore"},"Tap on a song for more info"),i.a.createElement("div",{className:"list"},i.a.createElement("div",{className:"left"},l.map(function(e){return i.a.createElement("p",{key:e}," ",e," ")})),i.a.createElement("div",{className:"right"},s.map(function(e){return i.a.createElement("p",{key:e}," ",e," ")}))))}return d(""),null}())}a(29);function O(e){var t=e.songInfo,a=e.hoveredSong,n=[];for(var r in t)a===t[r].track?n.push(i.a.createElement("li",{key:r,style:{color:"#1DB954",marginLeft:-12.5}},i.a.createElement("span",{style:{marginLeft:-6.5}}," ",t[r].track," "))):n.push(i.a.createElement("li",{key:r,style:{color:"white",listStyleType:"none"}}," ",t[r].track," "));return i.a.createElement("div",{className:"margins"},i.a.createElement("div",{className:"top"},i.a.createElement("h2",{className:"header"}," ",n.length<=0?"Loading...":"Your Top 10"),i.a.createElement("p",{className:"moreInfo"}," ",n.length<=0?"If this process takes > 2 minutes, please refresh or try again later.":"Hover over a song for more info"),i.a.createElement("div",{className:"songs"},n.map(function(e){return i.a.createElement("div",null," ",e," ")}))))}var k=i.a.memo(function(e){var t,a=e.draw,r=e.height,o=e.width,l=e.imageSize,s=e.popularity,c=e.valence,u=e.songInfo,m=e.smallFormat,d=y(),g=function(){var e=Object(n.useState)({x:0,y:0}),t=Object(p.a)(e,2),a=t[0],i=t[1];return w.isMobile?Object(n.useEffect)(function(){var e=function(e){e.stopPropagation(),i({x:e.touches[0].clientX,y:e.touches[0].clientY})};return window.addEventListener("touchstart",e),function(){window.removeEventListener("touchstart",e)}},[]):Object(n.useEffect)(function(){var e=function(e){return i({x:e.clientX,y:e.clientY})};return window.addEventListener("mousemove",e),function(){window.removeEventListener("mousemove",e)}},[]),a}(),f=i.a.useRef(),h=Object(n.useRef)(0),v=Object(n.useRef)(0);i.a.useEffect(function(){var e=f.current.getBoundingClientRect(),t=f.current.getContext("2d");f.current.width=o*devicePixelRatio,f.current.height=r*devicePixelRatio,t.scale(devicePixelRatio,devicePixelRatio),f.current.style.width=o+"px",f.current.style.height=r+"px",t.beginPath();var n=t.createLinearGradient(0,0,0,r);n.addColorStop(0,"darkturquoise"),n.addColorStop(1,"greenyellow"),t.strokeStyle=n,t.lineWidth=1.5,t.moveTo(o/2,0),t.lineTo(o/2,o),t.stroke(),t.beginPath(),(n=t.createLinearGradient(0,0,o,0)).addColorStop(0,"yellow"),n.addColorStop(1,"magenta"),t.strokeStyle=n,t.moveTo(0,o/2),t.lineTo(o,o/2),t.stroke(),t.beginPath(),t.fillStyle="yellow",t.arc(5,o/2,5,0*Math.PI,2*Math.PI),t.fill(),t.beginPath(),t.fillStyle="magenta",t.arc(o-5,o/2,5,0*Math.PI,2*Math.PI),t.fill(),t.beginPath(),t.fillStyle="darkturquoise",t.arc(o/2,5,5,0*Math.PI,2*Math.PI),t.fill(),t.beginPath(),t.fillStyle="greenyellow",t.arc(o/2,o-5,5,0*Math.PI,2*Math.PI),t.fill(),a(t),h.current=e.x,v.current=e.y}),t=g.x-h.current>=o/2&&m?-100:0;var A=Object(n.useState)(""),S=Object(p.a)(A,2),k=S[0],N=S[1];return w.isMobile||d<900?i.a.createElement("div",null,i.a.createElement("canvas",{className:"canvas",ref:f,height:r,width:o}),i.a.createElement(b,{x:g.x-h.current,y:g.y-v.current,imageSize:l,axisLength:o,popularity:s,valence:c,songInfo:u,smallFormat:m,isMobile:!0})):i.a.createElement("div",{style:{display:"flex"}},i.a.createElement("canvas",{className:"canvas",ref:f,height:r,width:o}),i.a.createElement(E.a,{className:"test",visible:!0,offsetX:t,offsetY:0},i.a.createElement(b,{x:g.x-h.current,y:g.y-v.current,imageSize:l,axisLength:o,popularity:s,valence:c,songInfo:u,smallFormat:m,isMobile:!1,setHovered:N})),i.a.createElement(O,{songInfo:u,hoveredSong:k}))},function(){return!1});function N(e){var t=e.height,a=e.width,n=e.smallFormat,r=i.a.useRef();return i.a.useEffect(function(){var e=r.current.getContext("2d");r.current.width=a*devicePixelRatio,r.current.height=t*devicePixelRatio,e.scale(devicePixelRatio,devicePixelRatio),r.current.style.width=a+"px",r.current.style.height=t+"px";var i=88,o=113,l=5,s="14px",c=12,u=125;n&&(s="12px",l=4,i=75,o=95,c=11,u=104),e.beginPath();var m=e.createLinearGradient(i,35,o-10,35);m.addColorStop(0,"darkturquoise"),m.addColorStop(1,"greenyellow"),e.strokeStyle=m,e.lineWidth=1.5,e.moveTo(i,35),e.lineTo(o,35),e.stroke(),e.beginPath(),(m=e.createLinearGradient(i,15,o,15)).addColorStop(0,"yellow"),m.addColorStop(1,"magenta"),e.strokeStyle=m,e.moveTo(i,15),e.lineTo(o,15),e.stroke(),e.beginPath(),e.fillStyle="yellow",e.arc(i-l,15,l,0*Math.PI,2*Math.PI),e.fill(),e.beginPath(),e.fillStyle="magenta",e.arc(o-l,15,l,0*Math.PI,2*Math.PI),e.fill(),e.beginPath(),e.fillStyle="darkturquoise",e.arc(i-l,35,l,0*Math.PI,2*Math.PI),e.fill(),e.beginPath(),e.fillStyle="greenyellow",e.arc(o-l,35,l,0*Math.PI,2*Math.PI),e.fill(),e.fillStyle="grey",e.font=s+" Helvetica",e.fillText("underrated",0,18),e.fillStyle="grey",e.font=s+" Helvetica",e.fillText("happy :))",c,38),e.fillStyle="grey",e.font=s+" Helvetica",e.fillText("basic",u,18),e.fillStyle="grey",e.font=s+" Helvetica",e.fillText("sad :(",u,38)}),i.a.createElement("div",null,i.a.createElement("canvas",{className:"keyCanvas",ref:r,height:t,width:a}))}a(30);function x(e){var t,a,n=e.items,r=e.popularity,o=e.valence,l=e.songDictionary,s={},c=y(),u=!1,m=!1;if(c>900?(t=.038*c,a=.4*c):(t=.1*c,a=.77*c,u=!0),c<400&&(m=!0),null!==n)for(var d=0;d<n.length;d++)s[n[d].id]=n[d].album.images[0].url;var g={};function f(e){if(Object.keys(g).length<=0){var n=function(){var n=new Image;n.src=s[i];var l=A(r[i],o[i],a,t);n.onload=function(){e.drawImage(n,l[0],l[1],t,t)},g[i]=n};for(var i in s)n()}else for(var l in g){var c=A(r[l],o[l],a,t);e.drawImage(g[l],c[0],c[1],t,t)}}return s.length<10?i.a.createElement("p",{className:"sorry"}," Loading..."):c<300?i.a.createElement("p",{className:"sorry"},"We're sorry, your display is too small to properly view the data. Please switch to a device with a larger screen size."):i.a.createElement("div",null,i.a.createElement("div",{className:"heading"},i.a.createElement("h2",{className:"header",style:{fontSize:"2.25em",marginBottom:0}}," Where Your Music Falls "),i.a.createElement("div",{className:"key"},i.a.createElement(N,{height:50,width:a,smallFormat:m}))),u?i.a.createElement("div",{className:"smallerCanvas"},i.a.createElement(k,{draw:f,height:a,width:a,imageSize:t,popularity:r,valence:o,songInfo:l,smallFormat:u})):i.a.createElement("div",{className:"bigCanvas"},i.a.createElement(k,{draw:f,height:a,width:a,imageSize:t,popularity:r,valence:o,songInfo:l,smallFormat:u})))}a(31);var I=a(15),P=a.n(I),B=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).state={token:null,items:null,no_data:!1,valence:{},popularity:{},songDictionary:{}},e.getTopSongs=e.getTopSongs.bind(Object(d.a)(Object(d.a)(e))),e.getAudioFeatures=e.getAudioFeatures.bind(Object(d.a)(Object(d.a)(e))),e.getPopularity=e.getPopularity.bind(Object(d.a)(Object(d.a)(e))),e.getSongInfo=e.getSongInfo.bind(Object(d.a)(Object(d.a)(e))),e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){document.body.style.zoom="100%",setInterval(this.decrTime,1e3);var e=v.access_token;e&&(this.setState({token:e}),this.getTopSongs(e))}},{key:"getTopSongs",value:function(e){var t=this;g.ajax({url:"https://api.spotify.com/v1/me/top/tracks?limit=10&time_range=long_term",type:"GET",beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+e)},success:function(a){a?(t.setState({items:a.items,no_data:!1}),t.getAudioFeatures(e),t.getPopularity(e),t.getSongInfo(e)):window.alert("NOOOOO we couldn't get your top songs :((")}})}},{key:"getSongInfo",value:function(e){for(var t=this,a=function(){var a=t.state.items[n].id;t.setState({genreList:[]});var r=t.state.items[n].name,o=t.state.items[n].artists,l=t.state.items[n].album.images[0].url;for(i=0;i<o.length;i++){var s=o[i].id;g.ajax({url:"https://api.spotify.com/v1/artists/"+s,type:"GET",beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+e)},success:function(e){if(e){var n=t.state.songDictionary;n[a]=a in n?{track:r,artists:o,genres:n[a].genres.concat(e.genres),src:l}:{track:r,artists:o,genres:e.genres,src:l},t.setState({songDictionary:n})}else window.alert("NOOOOO we couldn't get your top songs :((")}})}},n=0;n<this.state.items.length;n++){var i;a()}}},{key:"getAudioFeatures",value:function(e){for(var t=this,a=function(){var a=t.state.items[n].id;g.ajax({url:"https://api.spotify.com/v1/audio-features?ids="+a,type:"GET",beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+e)},success:function(e){if(e){var n=t.state.valence;n[a]=[100-100*e.audio_features[0].valence],t.setState({valence:n})}else window.alert("NOOOOO we couldn't get your top songs :((")}})},n=0;n<this.state.items.length;n++)a()}},{key:"getPopularity",value:function(e){for(var t=this,a=function(){var a=t.state.items[n].id;g.ajax({url:"https://api.spotify.com/v1/tracks/"+a,type:"GET",beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+e)},success:function(e){if(e){var n=t.state.popularity;n[a]=[e.popularity],t.setState({popularity:n})}else window.alert("NOOOOO we couldn't get your top songs :((")}})},n=0;n<this.state.items.length;n++)a()}},{key:"render",value:function(){return i.a.createElement("div",{className:"App"},i.a.createElement("div",{className:"App-header"},!this.state.token&&i.a.createElement("div",{className:"main"},i.a.createElement("h1",{className:"title"}," plotify "),i.a.createElement("img",{className:"logo",src:P.a,alt:"logo"}),i.a.createElement("h1",{className:"divider"}," "),i.a.createElement("a",{className:"btn btn--loginApp-link",href:"".concat("https://accounts.spotify.com/authorize","?client_id=").concat("3a73a562c583499ea19565fc3ebc4bcc","&redirect_uri=").concat("https://plotifyapp.github.io/","&scope=").concat(f.join("%20"),"&response_type=token&show_dialog=true")},"Log in with Spotify"),i.a.createElement("p",{className:"hi"}," made with <3 by Kaily Liu and Joyce He ")),this.state.token&&!this.state.no_data&&i.a.createElement("div",null,i.a.createElement(x,{items:this.state.items,popularity:this.state.popularity,valence:this.state.valence,songDictionary:this.state.songDictionary})),this.state.no_data&&i.a.createElement("p",null,"NOOO it doesn't seem like we were able to retrieve your data :(")))}}]),t}(n.Component);o.a.render(i.a.createElement(B,null),document.getElementById("root"))}],[[16,1,2]]]);
//# sourceMappingURL=main.69c18623.chunk.js.map